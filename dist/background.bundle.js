(()=>{console.log("Background script loaded.");var e={};chrome.runtime.onInstalled.addListener((function(){chrome.contextMenus.create({id:"gradeAgreement",title:"Grade this Agreement",contexts:["selection"]},(function(){chrome.runtime.lastError?console.error("Error creating context menu:",chrome.runtime.lastError.message):console.log("Context menu created successfully.")}))})),chrome.runtime.onMessage.addListener((function(r,o,s){if("analyzeText"===r.action){console.log("Received text for analysis.");try{if(r.text){var t=(console.log("Calculating readability score for the given text."),"B"),n=(console.log("Analyzing content with TensorFlow.js..."),"A");e={clarityGrade:t,contentGrade:n,keyExcerpts:"This is a key excerpt from the agreement.",reasons:"The agreement has clear terms and favors user rights."},console.log("Analysis results stored.")}else console.error("No text provided for analysis."),s({error:"No text provided for analysis."})}catch(e){console.error("Error analyzing text:",e.message,e.stack),s({error:"Error analyzing text. Please check the console for more details."})}}else"requestAnalysisResults"===r.action&&(console.log("Received request for analysis results."),0!==Object.keys(e).length?(s(e),console.log("Analysis results sent from storage.")):(console.log("No stored analysis results found. Performing immediate analysis."),s({clarityGrade:"Placeholder grade",contentGrade:"Placeholder grade",keyExcerpts:"Immediate analysis not implemented in this placeholder.",reasons:"Immediate analysis logic should be implemented here."})));return!0}))})();